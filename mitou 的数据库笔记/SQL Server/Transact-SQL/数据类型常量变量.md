# 数据类型常量变量

## 数据类型

### binary 类型

| 类型           | 描述                                    |
| -------------- | --------------------------------------- |
| bit            | 允许 0、1 或 NULL                       |
| binary(n)      | 固定长度的二进制数据。最多 8,000 字节。 |
| varbinary(n)   | 可变长度的二进制数据。最多 8,000 字节。 |
| varbinary(max) | 可变长度的二进制数据。最多 2GB 字节。   |
| image          | 可变长度的二进制数据。最多 2GB。        |

### 整数类型

| 类型     | 描述 | 存储空间 |
| - | - | - |
| tinyint  | 允许从 0 到 255 的所有数字。      | 1 字节   |
| smallint | 允许从 -32,768 到 32,767 的所有数字。   | 2 字节   |
| int      | 允许从 -2,147,483,648 到 2,147,483,647 的所有数字。  | 4 字节   |
| bigint   | 允许介于 -9,223,372,036,854,775,808 和 9,223,372,036,854,775,807 之间的所有数字。 | 8 字节   |

### 浮点类型

浮动精度：

| 类型     | 描述   | 存储空间 |
| - | - | - |
| real     | 从 -3.40E + 38 到 3.40E + 38 的浮动精度数字数据。精确到第7位小数。 | 4 字节      |
| float(n) | 从 -1.79E + 308 到 1.79E + 308 的浮动精度数字数据。 参数 n 指示该字段保存 4 字节还是 8 字节。float(24) 保存 4 字节，而 float(53) 保存 8 字节。n 的默认值是 53。8 字节精确到第 15 为小数。 | 4 或 8 字节 |

固定精度：

| 类型         | 描述                                                         | 存储空间  |
| ------------ | ------------------------------------------------------------ | --------- |
| decimal(p,s) | 固定精度和比例的数字。允许从 -10^38 +1 到 10^38 -1 之间的数字。p 参数指示可以存储的最大位数（小数点左侧和右侧）。p 必须是 1 到 38 之间的值。默认是 18。s 参数指示小数点右侧存储的最大位数。s 必须是 0 到 p 之间的值。默认是 0。 | 5-17 字节 |
| numeric(p,s) | 固定精度和比例的数字。允许从 -10^38 +1 到 10^38 -1 之间的数字。p 参数指示可以存储的最大位数（小数点左侧和右侧）。p 必须是 1 到 38 之间的值。默认是 18。s 参数指示小数点右侧存储的最大位数。s 必须是 0 到 p 之间的值。默认是 0。 | 5-17 字节 |

### 字符类型

- 常量需由单引号括起
- 字符类型如果没有指定长度，那么默认为 1 

char 字符串（ASCII 字符）

| 类型         | 描述                                                         | 存储空间 |
| ------------ | ------------------------------------------------------------ | -------- |
| char(n)      | 固定长度的字符串。n 的取值为 1 ~ 8000；系统默认值为 1；若输入字符数小于 n，系统自动以空格填充；系统自动截断超出部分。 | n        |
| varchar(n)   | 可变长度的字符串。最多 8,000 个字符。存储大小是实际输出字符量加 2 个字节。 |          |
| varchar(max) | 可变长度的字符串。最多 1,073,741,824 个字符。                |          |
| text         | 可变长度的字符串。最多 2GB 字符数据。                        |          |

unicode 字符串

- char 类型名前加 n 
- 两字节一个字符

| 类型          | 描述                                               | 存储空间 |
| ------------- | -------------------------------------------------- | -------- |
| nchar(n)      | 固定长度的 Unicode 数据。n 的取值为 1 ~ 4,000      | n        |
| nvarchar(n)   | 可变长度的 Unicode 数据。最多 4,000 个字符。       |          |
| nvarchar(max) | 可变长度的 Unicode 数据。最多 536,870,912 个字符。 |          |
| ntext         | 可变长度的 Unicode 数据。最多 2GB 字符数据。       |          |

### 日期和时间类型

| 类型           | 描述                                                         | 存储空间   |
| -------------- | ------------------------------------------------------------ | ---------- |
| date           | 仅存储日期。从 0001 年 1 月 1 日 到 9999 年 12 月 31 日。格式为：YYYY-MM-DD | 3 bytes    |
| time           | 仅存储时间。精度为 100 纳秒。格式为：hh:mm:ss                | 3-5 bytes  |
| smalldatetime  | 从 1900 年 1 月 1 日 到 2079 年 6 月 6 日，精度为 1 分钟。   | 4 bytes    |
| datetime       | 从 1753 年 1 月 1 日 到 9999 年 12 月 31 日，精度为 3.33 毫秒。 | 8 bytes    |
| datetime2      | 从 1753 年 1 月 1 日 到 9999 年 12 月 31 日，精度为 100 纳秒。 | 6-8 bytes  |
| datetimeoffset | 与 datetime2 相同，外加时区偏移。                            | 8-10 bytes |
| timestamp      | 存储唯一的数字，每当创建或修改某行时，该数字会更新。timestamp 基于内部时钟，不对应真实时间。每个表只能有一个 timestamp 变量。 |            |

### 货币类型

使用时，应在数据前加上货币符号，如 ￥100.54 或 \$ 150.54；
（本质是有 4 位小数的 decimal 类型（固定精度））

| 类型       | 描述                                  | 存储空间 |
| ---------- | ------------------------------------- | -------- |
| smallmoney | 介于 -2^31 ~ (2^31 - 1)  的货币数据。 | 4 字节   |
| money      | 介于 -2^63 ~ (2^63 - 1)  的货币数据。 | 8 字节   |

### 其它数据类型

| 类型             | 描述                                                         | 存储空间 |
| ---------------- | ------------------------------------------------------------ | -------- |
| sql_variant      | 存储最多 8,000 字节不同数据类型的数据，除了 text、ntext 以及 timestamp。 |          |
| uniqueidentifier | 存储全局标识符 (GUID)。                                      |          |
| xml              | 存储 XML 格式化数据。最多 2GB。                              |          |
| cursor           | 存储对用于数据库操作的指针的引用。                           |          |
| table            | 存储结果集，供稍后处理。                                     |          |

### 自定义数据类型

创建时要考虑 3 个属性：

1. 数据类型的名称；
2. 所依据的系统数据类型（又称基类型）；
3. 是否可为空。

语法见《自定义数据类型与函数》。

## 常量

- 数值常量

	整型，实型
	bit 类型常量用数字 0 和 1 即可，大于 1 将自动转化为 1
	二进制常量用 0x 开头，后面跟十六进制表示

- 字符串常量

	单引号括起

- 日期和时间常量

	单引号括起的符合日期或时间格式的字符串
	如：
	'2019-02-15'
	'12:07:23'
	
## 变量

### 全局变量

- 在SQL Server中，全局变量是一种特殊类型的变量,服务器将维护这些变量的值。
- 全局变量以@@前缀开头,不必进行声明,它们属于系统定义的函数。

下表是SQL Server中一些常用的全局变量。

| 全局变量名称      | 描述                                                         |
| ----------------- | ------------------------------------------------------------ |
| @@CONNECTIONS     | 返回 SQL Server 自上次启动以来尝试的连接数。                 |
| @@CPU_BUSY        | 返回 SQL Server 自上次启动后的工作时间。                     |
| @@CURSOR_ROWS     | 返回连接上打开的上一个游标中的当前限定行的数目，确定当其被调用时检索了游标符合条件的行数。 |
| @@DATEFIRST       | 针对会话返回 SET DATEFIRST 的当前值，SET DATEFIRST 表示指定的每周的第一天。 |
| @@DBTS            | 返回当前数据库的当前 timestamp 数据类型的值，这一时间戳值在数据库中必须是唯一的。 |
| @@ERROR           | 返回执行的上一个 Transact-SQL 语句的错误号，如果前一个 Transact-SQL 语句执行没有错误，则返回 0。 |
| @@FETCH_STATUS    | 返回针对连接当前打开的任何游标发出的上一条游标 FETCH语句的状态。 |
| @@IDENTITY        | 返回上次插入的标识值。                                       |
| @@IDLE            | 返回 SQL Server 自上次启动后的空闲时间。结果以 CPU 时间增量或“时钟周期”表示，并且是所有 CPU 的累积。 |
| @@IO_BUSY         | 返回自从 SQL Server 最近一次启动以来，Microsoft SQL Server已经用于执行输入和输出操作的时间。其结果是 CPU 时间增量（时钟周期），并且是所有 CPU 的累积值 |
| @@LANGID          | 返回当前使用的语言的本地语言标识符 (ID)。                    |
| @@LANGUAGE        | 返回当前所用语言的名称。                                     |
| @@LOCK_TIMEOUT:   | 返回当前会话的当前锁定超时设置（毫秒）。                     |
| @@MAX_CONNECTIONS | 返回 SQL Server 实例允许同时进行的最大用户连接数。返回的数值不一定是当前配置的数值。 |
| @@MAX_PRECISION   | 按照服务器中的当前设置，返回 decimal 和 numeric 数据类型所用的精度级别。 |
| @@NESTLEVEL       | 返回对本地服务器上执行的当前存储过程的嵌套级别（初始值为 0）。 |
| @@OPTIONS         | 返回有关当前 SET 选项的信息。                                |
| @@PACK_RECEIVED   | 返回 SQL Server 自上次启动后从网络读取的输入数据包数。       |
| @@PACK_SENT       | 返回 SQL Server 自上次启动后写入网络的输出数据包个数。       |
| @@PACKET_ERRORS   | 返回自上次启动 SQL Server 后，在 SQL Server 连接上发生的网络数据包错误数。 |
| @@PROCID          | 返回 Transact-SQL 当前模块的对象标识符 (ID)。Transact-SQL模块可以是存储过程、用户定义函数或触发器。 |
| @@REMSERVER       | 返回远程 SQL Server 数据库服务器在登录记录中显示的名称。     |
| @@ROWCOUNT        | 返回受上一语句影响的行数。                                   |
| @@SERVERNAME      | 返回运行 SQL Server 的本地服务器的名称。                     |
| @@SERVICENAME     | 返回 SQL Server 正在其下运行的注册表项的名称。若当前实例为默认实例，则 @@SERVICENAME 返回 MSSQLSERVER。 |
| @@SPID            | 返回当前用户进程的会话 ID。                                  |
| @@TEXTSIZE        | 返回 SET 语句中的 TEXTSIZE 选项的当前值。                    |
| @@TIMETICKS       | 返回每个时钟周期的微秒数。                                   |
| @@TOTAL_ERRORS    | 返回 SQL Server 自上次启动之后所遇到的磁盘写入错误数。       |
| @@TOTAL_READ      | 返回 SQL Server 自上次启动后读取磁盘（不是读取高速缓存）的次数。 |
| @@TOTAL_WRITE     | 返回 SQL Server 自上次启动以来所执行的磁盘写入次数。         |
| @@TRANCOUNT       | 返回当前连接的活动事务数。                                   |
| @@VERSION         | 返回当前的 SQL Server 安装的版本、处理器体系结构、生成日期和操作系统。 |

### 局部变量

详见《基本语法》。
