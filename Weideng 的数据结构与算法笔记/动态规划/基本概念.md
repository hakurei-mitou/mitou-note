# 动态规划

即 dynamic programming。

## 基本思想

动态规划算法通常用于求解具有某种最优性质的问题。在这类问题中，可能会有许多可行解。每一个解都对应于一个值，我们希望找到具有最优值的解。

动态规划算法与分治法类似，其基本思想也是将待求解问题分解成若干个子问题，先求解子问题，然后从这些子问题的解得到原问题的解。

与分治法不同的是，适合于用动态规划求解的问题，经分解得到子问题往往不是互相独立的。

若用分治法来解这类问题，则分解得到的子问题数目太多，有些子问题被重复计算了很多次。

如果我们能够保存已解决的子问题的答案，而在需要时再找出已求得的答案，这样就可以避免大量的重复计算，节省时间。

我们可以用一个表来记录所有已解的子问题的答案。不管该子问题以后是否被用到，只要它被计算过，就将其结果填入表中，这就是动态规划法的基本思路。

具体的动态规划算法多种多样，但它们具有相同的填表格式。

## 术语

- 状态
	状态表示每个阶段开始面临的自然状况或客观条件，它不以人们的主观意志为转移，也称为不可控因素。
	过程的状态通常可以用一个或一组数来描述，称为状态变量。（类似于状态树（图）中的顶点）

- 阶段
	把所有求解问题的过程恰当地分成若干个相互联系的阶段，以便于求解，过程不同，阶段数就可能不同．描述阶段的变量称为阶段变量。（类似于状态树（图）中的边或点，一个阶段也可以是多条边或点的整体集合，比较多变）

- 决策
	一个阶段的状态给定以后，从该状态演变到下一阶段某个状态的一种选择（或一种行动）称为决策。在最优控制中，也称为控制。（类似于状态树（图）中的一条边）

- 最优决策
	一个阶段中所有决策中最优的决策（可多个）

- 策略
	由每个阶段的决策组成的序列称为策略。对于每一个实际的多阶段决策过程，可供选取的策略有一定的范围限制，这个范围称为允许策略集合。（类似于状态树（图）中的一条路径）

- 最优策略
	可行策略集合中达到最优效果的策略称为最优策略。

- 最优子结构
	即各阶段都具有到达其的最优策略。

- 重叠子问题
	求解过程中，重复求解的问题。

- 状态转移方程
	当前阶段到下一阶段，面对不同状态做出各种决策的状态转移规则。
## 特征

分析时需要考虑。

- 多阶段决策问题
	分多阶段进行决策，下一阶段的解与上一阶段的解相关，最后求出所有阶段的最优决策集合，即最优策略。

- 最优子结构
	问题的最优解包含子问题的最优解。反过来说就是，可以通过子问题的最优解，推导出问题的最优解。也可以理解为，后面阶段的状态可以通过前面状态推导出来。

- 重叠子问题
	动态规划将原来具有指数级时间复杂度的搜索算法改进成了具有多项式时间复杂度的算法。其中的关键在于解决冗余，这是动态规划算法的根本目的。（这也是记忆化搜索的特征）

- 无后效性
	如果在某个阶段上过程的状态已知，则从此阶段以后过程的发展变化仅与此阶段的状态有关，而与过程在此阶段以前的阶段所经历过的状态无关，称其具有无后效性。即后续的状态只依赖于之前已经存在的状态，可以不断通过“前”的状态推导“后”的状态。
## 状态树，状态图

动态规划的基本结构，也可由此分析贪心和递推，或其它算法。

可由此理解其相关术语含义及差别。

dp 是图论的子集，大部分 dp 都可以与图论中的“最短路”相互转换（在状态图中）。

## 全局状态空间

动态规划涉及到的所有状态组成的空间（动规数组的填充状态），可由此分析阶段分布，从而判断动规类型。

这也是对动规问题的一个状态总览，能帮助从全局把握动规的运行，即转移情况。

要懂得借助图形与几何的强有力的武器理解状态与状态转移，这对于分析遍历顺序也是很有帮助的。

## 状态转移方程

状态转移方程的推导与阶段分布的分析即是动态规划问题的关键。

状态转移方程即是在状态树，状态图中进行状态转移所遵循的规则的递推表达式。

**转移方程可能分段，可能有多个共同使用。**

动规问题一定要考虑好转移方程代表的意义，相同形式，不同的意义对应不同的微操作，可能有不同的结果。

动规与递推有许多相似的推导技巧，可以共用。

## 转移方式

注意：顺推和逆推只是代码的一种写法描述，与以下无关。

- 用其所依赖的状态更新当前的状态（用得较多）
	（即当前状态的入边）

- 用当前状态更新依赖它的状态
	（当前状态的出边）

哪个复杂度小（即少且容易确定）就用哪个。

## 分析步骤

1. 状态表示
	分析关系，确定动规特征（四个），确定状态维度，确定状态意义，确定状态的依赖因素，划分阶段，确定阶段顺序（根据无后效性），构造状态树、状态图，确定可行性等。

2. 转移方程
	确定计算方式，各方向顺序（填表顺序），循环范围，循环范围内的无效点，
	分析时间、空间复杂度等。（注意阶段的划分，明确各状态的相对位置，便于后续分析）

3. 边界分析
	初始化及特殊情况，是否需要额外扫描找出最优解等。

4. 优化分析
	进一步分析复杂度，化简转移方程，减少循环，滚动数组，改变填表顺序是否影响正确性，意义扭转等。
## 分析技巧

注意已计算出的状态和当前要计算的状态的关系。

- 依赖分析
	考虑状态间的依赖关系，使用依赖因素构造状态意义（如标定结尾）。

- 阶段间隔分析
	规模从小到大的相邻阶段不易推出状态（阶段）转移时，考虑间隔的状态（阶段）的关系。

- 阶段回溯分析
	规模从小到大时若间隔分析仍不易推出状态（阶段）转移，考虑将每一个新的状态（阶段）与此前每一个规模比其小的状态（阶段）进行比较，从而得出关系。

- 遍历顺序的图形分析：
	绘制转移示意图，分析初始化位置，转移方向，先后状态，是否覆盖，是否已求出等因素可用方格图等图形进行表示分析。

- 升维分析
	如果实在看不懂代码，考虑其是否使用了空间优化策略，将其升维以理解。
	将某些方法广义化，扩展之后，空间优化策略可能会失效，此时就要回归一般化的维度。

## 区分对比

### 动态规划与递推

- 动态规划的求解需要递推式，从而推出状态转移方程。
- 递推即从性质相似的小规模问题逐步到大规模问题。
- 递推是没有决策过程的，不是多阶段决策问题，只是单纯地存储数据避免重复运算。
- 动规每个阶段要面对多个状态，递推只是问题规模上的变化。


### 动态规划与贪心

- 都面对多个状态，
- 动规每个阶段可能有多个最优决策，但贪心只有一个最优决策。
- 贪心必须要具有局部最优解就是全局最优解的性质。
- 贪心算法对每个子问题的解决方案都做出选择，不能回退。
- 动态规划则会根据以前的选择结果对当前进行选择，有回退功能。


### 动态规划与记忆化搜索

- 记忆化的动态规划递归写法，就是记忆化搜索，
- 但不是所有的情况两者都能互相转化。
- 记忆化搜索是自上而下解决问题；
- 动态规划是自下而上解决问题。
- 记忆化搜索若有决策过程，则是树形动规。
- 递归调用有额外开销，所以动态规划一般比记忆化搜索快。
- 记忆化搜索比动态规划更直观。